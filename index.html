<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>QR Code Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #qrcode canvas {
            border-radius: 15px;
        }
    </style>
</head>
<body class="bg-light">
<div class="container mt-5">
    <div class="card shadow-lg p-4">
        <h2 class="text-center text-primary">?? QR Code ???????</h2>
        <div class="mt-3">
            <label class="form-label">?? QR ????? ?????:</label>
            <select id="qrType" class="form-select" onchange="toggleFields()">
                <option value="website">Website</option>
                <option value="pdf">PDF</option>
                <option value="wifi">WiFi</option>
            </select>

            <div id="websiteFields" class="mt-2">
                <label class="form-label">?? Website URL:</label>
                <input type="text" id="websiteInput" class="form-control" placeholder="https://example.com">
            </div>

            <div id="pdfFields" class="mt-2" style="display: none;">
                <label class="form-label">?? PDF URL:</label>
                <input type="text" id="pdfInput" class="form-control" placeholder="https://example.com/file.pdf">
            </div>

            <div id="wifiFields" class="mt-2" style="display: none;">
                <label class="form-label">?? ????????? ??? (SSID):</label>
                <input type="text" id="ssidInput" class="form-control" placeholder="?????: MyWiFi">
                <label class="form-label mt-2">?? ???????????? ?????:</label>
                <select id="securityInput" class="form-select">
                    <option value="WPA">WPA/WPA2</option>
                    <option value="WEP">WEP</option>
                    <option value="nopass">???? ?????</option>
                </select>
                <label class="form-label mt-2">?? ???? ??:</label>
                <input type="text" id="passwordInput" class="form-control" placeholder="???? ?? (?????? ?????? ???)">
            </div>

            <label class="form-label mt-3">?? ???? (??????????):</label>
            <input type="file" id="logoInput" accept="image/*" class="form-control">

            <button onclick="generateQR()" class="btn btn-success mt-3 w-100">? ??????</button>
        </div>

        <div id="qrResult" class="text-center mt-4" style="display: none;">
            <h5>? ???? QR ???:</h5>
            <div id="qrcode" class="mx-auto"></div>
            <a id="downloadLink" href="#" download="qr_code.png" class="btn btn-primary mt-3">?? ?????</a>
        </div>

        <p id="error" class="text-danger text-center mt-3" style="display: none;"></p>
    </div>
</div>

<script src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
<script>
    let qrCode;

    function toggleFields() {
        const type = document.getElementById("qrType").value;
        document.getElementById("websiteFields").style.display = type === "website" ? "block" : "none";
        document.getElementById("pdfFields").style.display = type === "pdf" ? "block" : "none";
        document.getElementById("wifiFields").style.display = type === "wifi" ? "block" : "none";
    }

    function generateQR() {
        const type = document.getElementById("qrType").value;
        const error = document.getElementById("error");
        const result = document.getElementById("qrResult");
        const qrcodeDiv = document.getElementById("qrcode");
        let data = "";

        if (type === "website") {
            data = document.getElementById("websiteInput").value;
            if (!data) return showError("Website URL ??????? ??!");
        } else if (type === "pdf") {
            data = document.getElementById("pdfInput").value;
            if (!data) return showError("PDF URL ??????? ??!");
        } else if (type === "wifi") {
            const ssid = document.getElementById("ssidInput").value;
            const security = document.getElementById("securityInput").value;
            const password = document.getElementById("passwordInput").value;
            if (!ssid) return showError("????????? ??? ??????? ??!");
            data = `WIFI:S:${ssid};T:${security};P:${password};;`;
        }

        error.style.display = "none";
        result.style.display = "none";
        qrcodeDiv.innerHTML = "";

        const fileInput = document.getElementById("logoInput");
        const imageFile = fileInput.files[0];

        const config = {
            width: 300,
            height: 300,
            type: "canvas",
            data: data,
            image: undefined,
            margin: 10,
            qrOptions: { errorCorrectionLevel: "H" },
            dotsOptions: {
                type: "rounded",
                color: "#0d6efd"
            },
            backgroundOptions: {
                color: "#ffffff"
            },
            imageOptions: {
                crossOrigin: "anonymous",
                hideBackgroundDots: true,
                imageSize: 0.4,
                margin: 5
            },
            cornersSquareOptions: {
                type: "extra-rounded",
                color: "#0d6efd"
            },
            cornersDotOptions: {
                type: "dot",
                color: "#0d6efd"
            }
        };

        if (imageFile) {
            const reader = new FileReader();
            reader.onload = function (e) {
                config.image = e.target.result;
                buildQR(config);
            };
            reader.readAsDataURL(imageFile);
        } else {
            buildQR(config);
        }
    }

    function buildQR(config) {
        qrCode = new QRCodeStyling(config);
        const qrcodeDiv = document.getElementById("qrcode");
        qrCode.append(qrcodeDiv);

        qrCode.getRawData("png").then(blob => {
            document.getElementById("downloadLink").href = URL.createObjectURL(blob);
            document.getElementById("qrResult").style.display = "block";
        }).catch(() => {
            showError("QR ??? ???????? ????? ??????!");
        });
    }

    function showError(message) {
        const error = document.getElementById("error");
        error.textContent = message;
        error.style.display = "block";
        document.getElementById("qrResult").style.display = "none";
    }

    toggleFields();
</script>
</body>
</html>
